webpackJsonp([27],{165:function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c(342),e=c(611),f=c(58),g=f(d.a,e.a,!1,function(){c(605)},"data-v-5a6e99db",null);b["default"]=g.exports},200:function(a,b,c){"use strict";b.__esModule=!0;var d=c(201),e=function(a){return a&&a.__esModule?a:{default:a}}(d);b.default=function(a,b,c){return b in a?(0,e.default)(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}},201:function(a,b,c){a.exports={default:c(202),__esModule:!0}},202:function(a,b,c){c(203);var d=c(2).Object;a.exports=function(a,b,c){return d.defineProperty(a,b,c)}},203:function(a,b,c){var d=c(4);d(d.S+d.F*!c(6),"Object",{defineProperty:c(5).f})},342:function(a,b,c){"use strict";var d=c(200),e=c.n(d),f=c(36),g=c.n(f),h=c(37),i=c.n(h),j=c(607),k=c(344),l=c(57),m=c(60);b.a={name:"materials",components:{ProjectEdit:j.a},data:function(){return{multipleSelection:[],typeList:[{name:"\u9650\u65F6\u4FC3\u9500",value:1},{name:"\u62FC\u56E2\u4FC3\u9500",value:2}],list:[],tableheight:0.45*document.body.clientHeight+"px",total:null,listLoading:!0,listQuery:{page:1,limit:20,sort:null,searchKey:""},auth:{MATERIALS_ADD:!1,MATERIALS_DELETE:!1,MATERIALS_EDIT:!1}}},mounted:function(){var a=this;return i()(g.a.mark(function b(){return g.a.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,l.a("STOCK_PROJECT");case 2:return a.auth.MATERIALS_DELETE=b.sent,b.next=5,l.a("STOCK_PROJECT");case 5:return a.auth.MATERIALS_ADD=b.sent,b.next=8,l.a("STOCK_PROJECT");case 8:a.auth.MATERIALS_EDIT=b.sent,a.getData();case 10:case"end":return b.stop();}},b,a)}))()},methods:e()({handleCurrentChange:function(a){this.listQuery.page=a,this.getData()},getData:function(){var a=this;this.listLoading=!0,k.e(this.listQuery.searchKey,this.listQuery.page,this.listQuery.limit,this.listQuery.sort).then(function(b){a.listLoading=!1,"success"===b.error?(a.total=b.data.total,a.list=b.data.list):"invaild_token"===b.error||"not_login"===b.error?a.$router.push("/login"):b.error_description?a.$message.error(b.error_description):a.$message.error(b.error)})},search:function(){this.listQuery.page=1,this.getData()},add:function(){this.$refs.ProjectEdit.showNew()},hanldeSort:function(a){this.listQuery.sort=a.prop+("ascending"==a.order?"":" desc"),this.getData()},handleEdit:function(a,b){this.$refs.ProjectEdit.showEdit(b.projectId)},handleDelete:function(a,b){var c=this;this.$confirm("\u6B64\u64CD\u4F5C\u5C06\u6C38\u4E45\u5220\u9664\u8BE5\u4FC3\u9500["+b.projectName+"], \u662F\u5426\u7EE7\u7EED?","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(function(){k.b([b.projectId]).then(function(a){"success"===a.error?(c.$message({type:"success",message:"\u5220\u9664\u6210\u529F!"}),c.getData()):c.$message({type:"error",message:c.$t(a.error)})})})},delAll:function(){var a=this,b=this.multipleSelection.length;return 0==b?void this.$message({type:"error",message:"\u8BF7\u52FE\u9009\u9700\u8981\u5220\u9664\u7684\u8BB0\u5F55\uFF01"}):void this.$confirm("\u6B64\u64CD\u4F5C\u5C06\u6C38\u4E45\u5220\u9664\u52FE\u9009\u7684"+b+"\u6761\u8BB0\u5F55, \u662F\u5426\u7EE7\u7EED?","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(i()(g.a.mark(function b(){var c;return g.a.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return c=[],b.next=3,a.multipleSelection.forEach(function(a){c.push(a.projectId)});case 3:k.b(c).then(function(b){"success"===b.error?(a.$message({type:"success",message:"\u5220\u9664\u6210\u529F!"}),a.multipleSelection=[],a.getData()):a.$message({type:"error",message:a.$t(b.error)})});case 4:case"end":return b.stop();}},b,a)})))},handleSelectionChange:function(a){this.multipleSelection=a},handleSizeChange:function(a){this.listQuery.limit=a,this.getData()}},"handleCurrentChange",function(a){this.listQuery.page=a,this.getData()})}},343:function(a,b,c){"use strict";var d=c(36),e=c.n(d),f=c(37),g=c.n(f),h=c(344),i=c(60);b.a={data:function(){return{editVisible:!1,title:"\u7F16\u8F91",button_loading:!1,form:{project_id:null,project_name:"",unit:0,standard:1,description:""},rules:{project_name:[{required:!0,message:"\u8BF7\u8F93\u5165\u9879\u76EE\u540D\u79F0",trigger:"blur"}]}}},mounted:function(){},methods:{showNew:function(){this.title="\u65B0\u589E",this.resetForm(),this.typeDisable=!1,this.editVisible=!0},showEdit:function(a){var b=this;return g()(e.a.mark(function c(){return e.a.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return b.title="\u7F16\u8F91",b.resetForm(),b.editVisible=!0,b.typeDisable=!0,c.next=6,b.getMaterials(a);case 6:case"end":return c.stop();}},c,b)}))()},submitForm:function(a){var b=this;this.$refs[a].validate(function(a){return!!a&&void(b.button_loading=!0,b.form.project_id?h.c(b.form.project_id,b.form.project_name,b.form.unit,b.form.standard,b.form.description).then(function(a){"success"===a.error?(b.button_loading=!1,b.$message({type:"success",message:"\u7F16\u8F91\u6210\u529F!"}),b.$emit("refresh"),b.editVisible=!1):b.$message({type:"error",message:b.$t(a.error)})}):h.a(b.form.project_name,b.form.unit,b.form.standard,b.form.description).then(function(a){b.button_loading=!1,"success"===a.error?(b.$message({type:"success",message:"\u6DFB\u52A0\u6210\u529F!"}),b.$emit("refresh"),b.editVisible=!1):b.$message({type:"error",message:b.$t(a.error)})}))})},resetForm:function(){this.form.project_id=null,this.form.project_name="",this.form.unit="",this.form.standard="",this.form.description=""},getMaterials:function(a){var b=this;h.d(a).then(function(a){"success"===a.error?(b.form.project_id=a.data.shopMaterials.project_id,b.form.project_name=a.data.shopMaterials.project_name,b.form.unit=a.data.shopMaterials.unit,b.form.standard=a.data.shopMaterials.standard,b.form.description=a.data.shopMaterials.description):b.$message.error(b.$t(data.error))})}}}},344:function(a,b,c){"use strict";c.d(b,"e",function(){return l}),c.d(b,"a",function(){return n}),c.d(b,"c",function(){return o}),c.d(b,"b",function(){return p}),c.d(b,"d",function(){return q});var d=c(36),e=c.n(d),f=c(37),g=c.n(f),h=c(59),i=c(57),j=function(){var a=g()(e.a.mark(function a(b,c,d,f,g,j){return e.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,i.f(h.a+"/api/v1/materialsLog/list",{type:1,key:b,page:c,pageSize:d,sort:f,start_time:g,end_time:j});case 3:return a.abrupt("return",a.sent);case 6:return a.prev=6,a.t0=a["catch"](0),a.abrupt("return",a.t0);case 9:case"end":return a.stop();}},a,this,[[0,6]])}));return function(){return a.apply(this,arguments)}}(),k=function(){var a=g()(e.a.mark(function a(b,c,d,f,g,j){return e.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,i.f(h.a+"/api/v1/materialsLog/list",{type:0,key:b,page:c,pageSize:d,sort:f,start_time:g,end_time:j});case 3:return a.abrupt("return",a.sent);case 6:return a.prev=6,a.t0=a["catch"](0),a.abrupt("return",a.t0);case 9:case"end":return a.stop();}},a,this,[[0,6]])}));return function(){return a.apply(this,arguments)}}(),l=function(){var a=g()(e.a.mark(function a(b,c,d,f){return e.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,i.f(h.a+"/api/v1/storeproject/list",{key:b,page:c,pageSize:d,sort:f});case 3:return a.abrupt("return",a.sent);case 6:return a.prev=6,a.t0=a["catch"](0),a.abrupt("return",a.t0);case 9:case"end":return a.stop();}},a,this,[[0,6]])}));return function(){return a.apply(this,arguments)}}(),m=function(){var a=g()(e.a.mark(function a(){return e.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,i.f(h.a+"/api/v1/stock/list/all");case 3:return a.abrupt("return",a.sent);case 6:return a.prev=6,a.t0=a["catch"](0),a.abrupt("return",a.t0);case 9:case"end":return a.stop();}},a,this,[[0,6]])}));return function(){return a.apply(this,arguments)}}(),n=function(){var a=g()(e.a.mark(function a(b,c,d,f){return e.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,i.j(h.a+"/api/v1/storeproject/add",{project_name:b,unit:c,standard:d,description:f});case 3:return a.abrupt("return",a.sent);case 6:return a.prev=6,a.t0=a["catch"](0),a.abrupt("return",a.t0);case 9:case"end":return a.stop();}},a,this,[[0,6]])}));return function(){return a.apply(this,arguments)}}(),o=function(){var a=g()(e.a.mark(function a(b,c,d,f,g){return e.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,i.j(h.a+"/api/v1/storeproject/edit",{project_id:b,project_name:c,unit:d,standard:f,description:g});case 3:return a.abrupt("return",a.sent);case 6:return a.prev=6,a.t0=a["catch"](0),a.abrupt("return",a.t0);case 9:case"end":return a.stop();}},a,this,[[0,6]])}));return function(){return a.apply(this,arguments)}}(),p=function(){var a=g()(e.a.mark(function a(b){return e.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,i.j(h.a+"/api/v1/storeproject/delete",{project_id:b});case 3:return a.abrupt("return",a.sent);case 6:return a.prev=6,a.t0=a["catch"](0),a.abrupt("return",a.t0);case 9:case"end":return a.stop();}},a,this,[[0,6]])}));return function(){return a.apply(this,arguments)}}(),q=function(){var a=g()(e.a.mark(function a(b){return e.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,i.e(h.a+"/api/v1/storeproject/"+b);case 3:return a.abrupt("return",a.sent);case 6:return a.prev=6,a.t0=a["catch"](0),a.abrupt("return",a.t0);case 9:case"end":return a.stop();}},a,this,[[0,6]])}));return function(){return a.apply(this,arguments)}}(),r=function(){var a=g()(e.a.mark(function a(b){return e.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,i.e(h.a+"/api/v1/stock/"+b);case 3:return a.abrupt("return",a.sent);case 6:return a.prev=6,a.t0=a["catch"](0),a.abrupt("return",a.t0);case 9:case"end":return a.stop();}},a,this,[[0,6]])}));return function(){return a.apply(this,arguments)}}(),s=function(){var a=g()(e.a.mark(function a(b,c,d,f){return e.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,i.j(h.a+"/api/v1/stock/edit/price",{mp_id:b,purchase_price:c,warning_quantity:d,materials_type:f});case 3:return a.abrupt("return",a.sent);case 6:return a.prev=6,a.t0=a["catch"](0),a.abrupt("return",a.t0);case 9:case"end":return a.stop();}},a,this,[[0,6]])}));return function(){return a.apply(this,arguments)}}(),t=function(){var a=g()(e.a.mark(function a(b,c,d,f){return e.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,i.j(h.a+"/api/v1/stock/operate/number",{json:b,operate_type:c,order_sn:d,remark:f});case 3:return a.abrupt("return",a.sent);case 6:return a.prev=6,a.t0=a["catch"](0),a.abrupt("return",a.t0);case 9:case"end":return a.stop();}},a,this,[[0,6]])}));return function(){return a.apply(this,arguments)}}(),u=function(){var a=g()(e.a.mark(function a(b){return e.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,i.f(h.a+"/api/v1/materialsLog/exportExcel",{seq_flag:b});case 3:return a.abrupt("return",a.sent);case 6:return a.prev=6,a.t0=a["catch"](0),a.abrupt("return",a.t0);case 9:case"end":return a.stop();}},a,this,[[0,6]])}));return function(){return a.apply(this,arguments)}}()},605:function(a,b,c){var d=c(606);"string"==typeof d&&(d=[[a.i,d,""]]),d.locals&&(a.exports=d.locals);c(133)("096190c7",d,!0,{})},606:function(a,b,c){b=a.exports=c(132)(!1),b.push([a.i,".handle-box[data-v-5a6e99db]{margin-bottom:20px}.handle-select[data-v-5a6e99db]{width:120px}.handle-input[data-v-5a6e99db]{width:300px;display:inline-block}.table[data-v-5a6e99db]{width:100%;font-size:14px}.red[data-v-5a6e99db]{color:red}",""])},607:function(a,b,c){"use strict";var d=c(343),e=c(610),f=c(58),g=f(d.a,e.a,!1,function(){c(608)},null,null);b.a=g.exports},608:function(a,b,c){var d=c(609);"string"==typeof d&&(d=[[a.i,d,""]]),d.locals&&(a.exports=d.locals);c(133)("03ab0571",d,!0,{})},609:function(a,b,c){b=a.exports=c(132)(!1),b.push([a.i,".tree{overflow:auto;height:200px}",""])},610:function(a,b){"use strict";b.a={render:function(){var a=this,b=a.$createElement,c=a._self._c||b;return c("el-dialog",{attrs:{title:a.title,visible:a.editVisible,width:"50%"},on:{"update:visible":function(b){a.editVisible=b}}},[c("el-form",{ref:"form",attrs:{model:a.form,rules:a.rules,"label-width":"110px"}},[c("el-form-item",{attrs:{label:"\u9879\u76EE\u540D\u79F0",prop:"project_name"}},[c("el-input",{model:{value:a.form.project_name,callback:function(b){a.$set(a.form,"project_name",b)},expression:"form.project_name"}})],1),a._v(" "),c("el-form-item",{attrs:{label:"\u5355\u4F4D"}},[c("el-input",{model:{value:a.form.unit,callback:function(b){a.$set(a.form,"unit",b)},expression:"form.unit"}})],1),a._v(" "),c("el-form-item",{attrs:{label:"\u9879\u76EE\u89C4\u683C"}},[c("el-input",{model:{value:a.form.standard,callback:function(b){a.$set(a.form,"standard",b)},expression:"form.standard"}})],1),a._v(" "),c("el-form-item",{attrs:{label:"\u63CF\u8FF0"}},[c("el-input",{model:{value:a.form.description,callback:function(b){a.$set(a.form,"description",b)},expression:"form.description"}})],1)],1),a._v(" "),c("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[c("el-button",{on:{click:function(){a.editVisible=!1}}},[a._v("\u53D6 \u6D88")]),a._v(" "),c("el-button",{attrs:{type:"primary",loading:a.button_loading},on:{click:function(){return a.submitForm("form")}}},[a._v("\u786E \u5B9A")])],1)],1)},staticRenderFns:[]}},611:function(a,b){"use strict";b.a={render:function(){var a=this,b=a.$createElement,c=a._self._c||b;return c("div",{staticClass:"table"},[c("div",{staticClass:"crumbs"},[c("el-breadcrumb",{attrs:{separator:"/"}},[c("el-breadcrumb-item",[a._v("\u5E93\u5B58\u4E2D\u5FC3")]),a._v(" "),c("el-breadcrumb-item",[a._v("\u5E93\u5B58\u9879\u76EE")])],1)],1),a._v(" "),c("div",{staticClass:"container"},[c("div",{staticClass:"handle-box"},[a.auth.MATERIALS_DELETE?c("el-button",{staticClass:"handle-del mr10",attrs:{type:"primary",icon:"el-icon-lx-delete"},on:{click:a.delAll}},[a._v("\u6279\u91CF\u5220\u9664")]):a._e(),a._v(" "),c("el-input",{staticClass:"handle-input mr10",attrs:{placeholder:"\u7B5B\u9009\u5173\u952E\u5B57"},model:{value:a.listQuery.searchKey,callback:function(b){a.$set(a.listQuery,"searchKey",b)},expression:"listQuery.searchKey"}}),a._v(" "),c("el-button",{attrs:{type:"primary",icon:"el-icon-lx-search"},on:{click:a.search}},[a._v("\u641C\u7D22")]),a._v(" "),a.auth.MATERIALS_ADD?c("el-button",{attrs:{type:"primary",icon:"el-icon-lx-add"},on:{click:a.add}},[a._v("\u65B0\u589E")]):a._e()],1),a._v(" "),c("el-table",{directives:[{name:"loading",rawName:"v-loading",value:a.listLoading,expression:"listLoading"}],ref:"multipleTable",staticClass:"table",attrs:{height:a.tableheight,data:a.list,border:"","empty-text":"\u6CA1\u6709\u4EFB\u4F55\u8BB0\u5F55","element-loading-text":"\u7ED9\u6211\u4E00\u70B9\u65F6\u95F4"},on:{"sort-change":a.hanldeSort,"selection-change":a.handleSelectionChange}},[c("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),a._v(" "),c("el-table-column",{attrs:{prop:"projectName",label:"\u9879\u76EE\u540D\u79F0","header-align":"center",align:"center",sortable:"","min-width":"120"}}),a._v(" "),c("el-table-column",{attrs:{prop:"unit",label:"\u5355\u4F4D","header-align":"center",align:"center",sortable:"","min-width":"120"}}),a._v(" "),c("el-table-column",{attrs:{prop:"standard",label:"\u89C4\u683C","header-align":"center",align:"center",sortable:"","min-width":"120"}}),a._v(" "),a.auth.MATERIALS_EDIT&&a.auth.MATERIALS_DELETE?c("el-table-column",{attrs:{label:"\u64CD\u4F5C","header-align":"center",align:"center","min-width":"160"},scopedSlots:a._u([{key:"default",fn:function(b){return[a.auth.MATERIALS_EDIT?c("el-button",{attrs:{type:"text",icon:"el-icon-edit"},on:{click:function(){return a.handleEdit(b.$index,b.row)}}},[a._v("\u7F16\u8F91")]):a._e(),a._v(" "),a.auth.MATERIALS_DELETE?c("el-button",{staticClass:"red",attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(){return a.handleDelete(b.$index,b.row)}}},[a._v("\u5220\u9664")]):a._e()]}}],null,!1,854890149)}):a._e()],1),a._v(" "),c("div",{staticClass:"pagination"},[c("el-pagination",{attrs:{background:"","current-page":a.listQuery.page,"page-sizes":[20,30,50],"page-size":a.listQuery.limit,layout:"total, sizes, prev, pager, next, jumper",total:a.total},on:{"size-change":a.handleSizeChange,"current-change":a.handleCurrentChange}})],1)],1),a._v(" "),c("ProjectEdit",{ref:"ProjectEdit",on:{refresh:a.getData}})],1)},staticRenderFns:[]}}});